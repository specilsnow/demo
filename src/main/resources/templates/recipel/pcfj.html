<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns="http://www.w3.org/1999/html">
<head>
	<title> 处方笺 </title>
	<meta charset="UTF-8">
	<meta name="generator" content="editplus" />
	<meta name="author" content="" />
	<meta name="keywords" content="" />
	<meta name="description" content="" />
	<!-- BEGIN GLOBAL MANDATORY STYLES -->
    <link href="${request.contextPath}/css/fonts-googleapis.css" rel="stylesheet" type="text/css"/>
    <link href="${request.contextPath}/metronic/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
    <link href="${request.contextPath}/metronic/css/simple-line-icons.min.css" rel="stylesheet" type="text/css"/>
    <link href="${request.contextPath}/metronic/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
    <link href="${request.contextPath}/metronic/css/bootstrap-switch.min.css" rel="stylesheet" type="text/css"/>
    <!-- END GLOBAL MANDATORY STYLES -->
    <!-- BEGIN THEME GLOBAL STYLES -->
    <link href="${request.contextPath}/metronic/css/components.min.css" rel="stylesheet" id="style_components"
          type="text/css"/>
    <link href="${request.contextPath}/metronic/css/plugins.min.css" rel="stylesheet" type="text/css"/>
    <!-- END THEME GLOBAL STYLES -->
    <!-- BEGIN THEME LAYOUT STYLES -->
    <link href="${request.contextPath}/metronic/css/layout.min.css" rel="stylesheet" type="text/css"/>
    <link href="${request.contextPath}/metronic/css/blue.min.css" rel="stylesheet" type="text/css" id="style_color"/>
    <link href="${request.contextPath}/metronic/css/custom.min.css" rel="stylesheet" type="text/css"/>
    <!-- END THEME LAYOUT STYLES -->
    <link rel="shortcut icon" href="favicon.ico"/>
    <!-- 样式冲突CSS -->
    <link rel="stylesheet" type="text/css" href="${request.contextPath}/css/style.css"/>
    <!-- layer css -->
    <link rel="stylesheet" type="text/css" href="${request.contextPath}/layui/css/layui.css">
    <!--datetimepicker  -->
    <link rel="stylesheet" type="text/css"
          href="${request.contextPath}/bootstrap/css/bootstrap-datetimepicker-master/css/bootstrap-datetimepicker.min.css"/>
	<!-- <script language="javascript" src="LodopFuncs.js"></script> -->
	<!-- <script language="javascript" src="${request.contextPath}/js/LodopFuncs.js"></script> -->
	<script type="text/javascript" src="${request.contextPath}/js/html2canvas/html2canvas.js"></script>
    <script type="text/javascript" src="${request.contextPath}/js/html2canvas/html2canvas.min.js"></script>
    <!-- <script type="text/javascript" src ="${request.contextPath}/js/html2canvas/jspdf.debug.js" integrity ="sha384-CchuzHs077vGtfhGYl9Qtc7Vx64rXBXdIAZIPbItbNyWIRTdG0oYAqki3Ry13Yzu"  crossorigin ="anonymous"> </script > -->
	<style>
	
</style>
</head>

<body>
	<div style="margin: 0px auto; width: 75%; margin-bottom: 80px; " id="d2">
	<ul id="recipelContainer" style="padding-bottom: 30px;">
		<div>
			<p style="text-align:center;font-size:25px;"><a>处方笺</a></p>
		</div>
		<li>
			<div class="form-group form-md-line-input has-success" style="width:100%;">
                <span class="col-xs-3 control-label" for="form_control_1"style="width:18%;">门诊、编号</span>
                <div class="col-xs-3"style="width:32%;">
                <input type="text" name="visitNo" class="form-control" value="${emr.visitNo!""}" placeholder="" readonly="readonly">
                </div>
                <span class="col-xs-3 control-label" for="form_control_1" style="width:11%;">姓名</span>
                <div class="col-xs-3" style="width:39%;">
                <input type="text" name="patientName" id="patientName" class="form-control" placeholder="" value="${emr.patientName!""}" onchange="findEmrHistoryByName($(this).val(),'','index')">
                <div class="form-control-focus"> </div>
                </div>
            </div>
		</li>
		<li>
			<div class="form-group form-md-line-input has-success" style="width: 100%;">
			 <span class="col-xs-2 control-label" for="form_control_1" style="width:11%;">性别</span>
                <div class="col-xs-4" style="width:19%;">
                <input type="text" class="form-control" name="age" placeholder="" value="${emr.sex!""}" readonly>
                </div>     
				<span class="col-xs-2 control-label" for="form_control_1" style="width:11%;">年龄</span>
                   <div class="col-xs-4" style="width:19%;">
                   <input type="text" class="form-control" name="age" placeholder="" value="${emr.age!""}" readonly>
                   </div>
                <span class="col-xs-2 control-label" for="form_control_1" style="width:11%;">日期</span>
                <div class="col-xs-4" style="width:29%;">
                @if(emr.createTime==""||emr.createTime==null){
                
                <input type="text" name="visitNo" class="form-control" value="${emr.createTime!""}" placeholder="" readonly="readonly">
                @}else{
                <input type="text" name="visitNo" class="form-control" value="${emr.createTime!"",'yyyy-MM-dd'}" placeholder="" readonly="readonly">
                @}
                </div>
            </div>
		
		</li>
		<li>
			<div class="form-group form-md-line-input has-success" style="width: 100%;">
                <span class="col-xs-1 control-label" for="form_control_1" style="width:11%;">诊断</span>
                <div class="col-xs-11" style="width:89%;">

                 @if(!isEmpty(emr.disease)){
          
                <div  name="visitNo" class="form-control" onclick="autosize(this)" style="min-height:30px;height: auto;margin-top: 0;"> ${ strutil.replace(emr.disease,"&&&","")}</div>
                @}else{
                 <div name="visitNo" class="form-control" onclick="autosize(this)" style="min-height:30px;height: auto;margin-top: 0;">${emr.disease!""}</div>
                @}
                </div>
            </div>
		</li>
		<li style="margin-top: 20px;">
			<span>
				<div class="form-group form-md-line-input has-success" style="width: 100%;">
                <span class="col-xs-12 control-label" for="form_control_1">用药信息</span>
            </div>
			</span>
		</li>
		@ var i=0;
		
		<li style=" min-height: 290px;">
		@for (recipelitem in emr.recipels[0].recipelItems){
			<span style="width: 24%;display: inline-block;margin-top:20px;">
				<label style="text-align:right;vertical-align:bottom; font-weight: bold; font-size: 15px;word-break: break-all;width: 88px;">${recipelitem.name!""}</label>
				<span style="display: inline-block;">
					<sup><label style="font-size: 15px; display: block;">${recipelitem.usage!""}</label></sup>
					<sub><label style="font-size: 15px;">${recipelitem.dosage!""}${recipelitem.unit!""}</label></sub>
				</span>
			</span>
			@i=i+1;
			@ if(i==4){
			@i=0;
		
			@}
			@}
		</li>
		
		<li >
			<div class="form-group form-md-line-input has-success" style="width: 100%;">
                <span class="col-xs-2 control-label" for="form_control_1">煎、服法</span>
                <div class="col-xs-10">
                <div name="visitNo" id="cfjjff" onclick="autosize(this)" class="form-control" style="min-height:30px;height: auto;margin-top: 0;" >${emr.recipels[0].jff}</div>
                </div>
            </div>
		</li>
		<li>
			<div class="form-group form-md-line-input has-success" style="width: 100%;">
                <span class=" control-label" for="form_control_1" style="float:left;width: 8.5%;">剂数</span>
                <div class="col-xs-9" style="width: 23%;">
                <input type="text" name="visitNo" class="form-control" value="${emr.recipels[0].js}" placeholder="" readonly="readonly">
                </div>
               <span class="control-label" style="float: left;width:5%;">付</span>
	           <span class="control-label" for="form_control_1" style="width: 5%;float: left;">注意</span>
	           <div class="col-md-4" style="width: 57.5%;float: left;">
				   <div class="form-control"   name="recipels[0].notice" id="form_control_1" style="min-height:30px;height: auto;margin-top: 0;">${emr.recipels[0].notice!""}</div>
	                <div class="form-control-focus"> </div>
	                <span class="help-block"></span>
	           </div>
            </div>
		</li>
		<li>
		<div class="form-group form-md-line-input has-success" style="width: 100%;">
                <span class="control-label" for="form_control_1" style="float:left;width: 8.5%;">金额</span>
                <div class="col-xs-4" style="width: 23%;">
                <input type="text" name="visitNo" class="form-control" value="${emr.recipels[0].je}" placeholder="" readonly="readonly">
                </div>
                <span class="col-xs-2 control-label" for="form_control_1" style="width: 11%;">医师</span>
                <div class="col-xs-4" style="width: 22%;">
                <input type="text" name="visitNo" class="form-control" value="${emr.doctorName}" placeholder="" readonly="readonly">
                </div>
                <span class="col-xs-2 control-label" for="form_control_1" style="width: 11%;">药师</span>
                <div class="col-xs-4" style="width: 22%;">
                <input type="text" name="visitNo" class="form-control"value="${emr.recipels[0].fhdoctor_name!""}" placeholder="" readonly="readonly">
                </div>
            </div>
		</li>
	</ul>
	<div>
        <div class="btns-group">
		@if(emr.recipels[0].status=='T') {
			<button class="btn btn-default" onclick="closeItem()"/>已拣药</button>
		@}else {
        <button style="float: right"><button class="btn btn-default" onclick="jywc()"/>拣药完成</button>
		@}
        <button class="btn btn-default" onclick="closeItem()"/>返回</button>
        </div>
        </div>
	</div>
	<div hidden id="dayin"></div>
</body>
<style>
	.form-group.form-md-line-input{
		overflow: hidden;
		margin-bottom: 10px;
	}
    body{
        background: #ffffff;
    }
    .form-group.form-md-line-input{
        padding-top:0;
    }
    .btns-group{
        text-align: right;
    }
    .btns-group button{
       border-radius: 5px!important;
        background: #74D5CA;
        color: #ffffff;
        border: none;
    }

</style>
<script src="${request.contextPath}/metronic/js/jquery.min.js" type="text/javascript"></script>
<script src="${request.contextPath}/metronic/js/bootstrap.min.js" type="text/javascript"></script>
<script src="${request.contextPath}/metronic/js/jquery.easypiechart.min.js" type="text/javascript"></script>
<script src="${request.contextPath}/metronic/js/app.min.js" type="text/javascript"></script>
<script src="${request.contextPath}/bootstrap/js/bootstrapValidator.js" type="text/javascript"></script>
<script src="${request.contextPath}/js/jquery.form.js" type="text/javascript"></script>
<script src="${request.contextPath}/layui/layui.js" type="text/javascript"></script>
<script src="${request.contextPath}/bootstrap/css/bootstrap-datetimepicker-master/js/bootstrap-datetimepicker.min.js"
        type="text/javascript"></script>
<script type="text/javascript"
        src="${request.contextPath}/bootstrap/css/bootstrap-datetimepicker-master/js/locales/bootstrap-datetimepicker.zh-CN.js"
        charset="UTF-8"></script>
<script>
function closeItem(){
	var index = parent.layer.getFrameIndex(window.name);
	setTimeout(function(){parent.layer.close(index)}, 1); 
}

/*捡药完成*/
function jywc() {
	$.ajax({
		url : "changeStatus",
		type : "post",
		data : {
			"id" : "${emr.recipels[0].id}",
			"status" : "T"
		},
		success: function(e){
			if(e) {
				alert("拣药完成！");
				window.parent.reloadTabel();
				closeItem();
			}else {
				alert("失败！");
			}
		}
	});
}
</script>
</html>